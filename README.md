**Colorembo — программа для извлечения из текста цвета**

Если создать эмбеддинг слова "банан", а также эмбеддинги названий различных цветов, то в общем случае к слову "банан" будут близки случайные цвета, а не "жёлтый" или "зелёный".
Эта программа изменяет пространсто эмбеддингов так, чтобы самыми близкими к слову "банан" оказались его собственные цвета, то есть "жёлтый" или "зелёный".

**Идея**

В обычном векторном поиске используется L2-расстояние между двумя векторами, которое для нормированных векторов вычисляет просто как дотпродукт.
Colorembo же делает дотпродукт не двух векторов, а трёх: банана, цвета и **маски**. Интерфейс программы построен вокруг поиска этой самой маски.

В качестве тренировочных данных используется расположенная на плоскости цветовая палитра, где в качестве цветов — названия этих цветов на 4 языках. Эту палитру ты видишь при запуске.

В качестве проверочных данных используется отдельная палитра, на которой расположены названия вещей, у которыйх есть стандартный цвет: роза, джинсы, лягушка -- и так далее. Увидеть её можно, если передать аргумент True в инициализацию класса Store() в фукнции __init__ класса Dot, расположенного в interface_main.py

Во время обучения маски в терминал выводится score -- процент вещей из проверочной палитры, цвет которых был верно определён при вычислении через обучаемую маску.

Графический интерфейс нужен, чтобы на глаз определять, насколько хорошо тренировочные слова подтянулись к целевой палитре.

**Почему это круто**

Маску можно интерпретировать как эмбеддинг -- это такой же вектор той же размерности. А это значит, что его можно инвертировать и получить текст на естественном языке.

Этот текст в сущности представляет собой заклинание, которое модифицирует пространство эмбеддингов! Такая техника заклинания векторных пространств может быть полезна при работе с векторными базами данных. Заклинание позволяет уточнить, в каком смысле должны быть похожи вектора. В случае colorembo это похожесть вещей в плане их цвета.

**Как запустить**
Програма запускается из скрипта interface_main. Обучение запускается в помощью кнопки ">".

**Кнопки**
**o+** — добавить новую ноду. Для корректной работы нужно добавить ключ openai в модуль get_embedding.py
**o-** — удалить ноду
**/+ **— добавить ребро
**/-** — удалить ребро
**>** — запустить обучение
**//** — связать ноду со всем остальными
**--** — отвязать ноду от всех остальных
**dtt** — связать все ноды со всеми
